<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>Intrinsic Brain Networks are Organized by Frequency Relationships</title>
    
    <meta name="description" content="impress.js is a presentation tool based on the power of CSS3 transforms and transitions in modern browsers and inspired by the idea behind prezi.com." />
    <meta name="author" content="Bartek Szopka" />
    
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />
    <link rel="stylesheet" href="./css//bokeh-0.12.2.min.css" type="text/css" />
    <link href="css/impress-demo.css" rel="stylesheet" />
    <link href="css/impress-slide-num.css" rel="stylesheet" />
    <link rel="shortcut icon" href="favicon.png" />
    <link rel="apple-touch-icon" href="apple-touch-icon.png" />
    
    <script src="./lib/three.min.js"></script>
    <script type="text/javascript" src="./lib/dat.gui.min.js"></script>
    <script type="text/javascript" src="./lib/OrbitControls.js"></script>
    <script type="text/x-mathjax-config">
     MathJax.Hub.Config({messageStyle: "none", tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
	    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
    </script>
    <script src="https://d3js.org/d3.v2.min.js"></script>
    <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-0.12.2.min.js"></script>
    
  </head>

  <body class="impress-not-supported">

    <div class="fallback-message">
      <p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
      <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
    </div>

    <div id="impress">

      <div id="zero" class="step slide" data-x="-2250" data-y="-1500" data-z="0" data-rotate-y="0" style="background-color: rgba(100,100,100,.2)">
	<h3><strong style="color: #037eb7; opacity: .8">Intrinsic Brain Networks are Organized by Frequency Relationships</strong></h3>
	<br><br>
	<ul style="font-size: 24px; font-weight: bold; list-style:none; opacity: .8;"> <!-- <ul class="a"> -->
	  <li>Shahir Mowlaei <span class="spr">pitt</span></li>
	  <li>Aarti Singh <span class="spr">cmu</span></li>
	  <li>Avniel Ghuman <span class="spr">pitt</span></li>
	</ul>
	<br>
	<div>
	  <p style="font-size: 20px; text-align: center; font-weight: bold; opacity: .8;">VAMP Meeting</p><br>
	  <div style="margin: auto">
	    <img src="./img/pittlogo.png" width="100px" style="margin: 0px auto; display: block; opacity: .6">
	  </div><br>
	  <p style="font-size: 24px; text-align:center; font-weight: bold; opacity: .95; color: #037eb7;">University of Pittsburgh</p>
	  <p style="font-size: 20px; text-align:center; font-weight: bold; opacity: .95; color: #037eb7;">Department of Neurological Surgery</p><br>
	  <p style="font-size: 16px; text-align:center; color: #505050; font-weight: bold; opacity: .8">March 21, 2017</p>
	</div>
      </div>

      <div id="" class="step slide" data-x="-1000" data-y="-1500">
	<h3 class="hD"><strong>Intro</strong></h3>
	<div class="cT">	
	  <br><br><br>
	  <ul class="ulS">
	    <li>Oscillatory synchrony is thought to reflect the integration of activity across large and small scale brain networks.</li><br>
	    <li>Aberrant synchrony has been observed in a number of neuropsychiatric disorders.</li><br>
	    <li>The frequency spectrum has been divided into broad frequency bands based on ad hoc observation in particular regions and networks and cognitive tasks.</li><br>
	    <li>It remains unknown whether these bands represent an intrinsic organizational property of the human connectome.</li>
	  </ul>
	</div>
      </div>

      <div id="" class="step slide" data-x="250" data-y="-1500">
	<h3 class="hD"><strong>Questions</strong></h3>
	<div class="cT">	
	  <br><br><br>
	  <ul class="ulS">
	    <li>Are there robust frequency bands/clusters in the intrinsic/resting-state connectome?</li><br>
	    <li>How do these bands compare to the ad hoc canonical frequency bands?</li><br>
	    <li>Are frequency bands associated with consistent connectivity profiles across individuals?</li><br>
	    <li>What are the band-specific networks?</li>
	  </ul>
	</div>
      </div>

      <div id="" class="step slide" data-x="-1000" data-y="-500">
	<h3 class="hD"><strong>Are there robust frequency bands/clusters in the intrinsic/resting-state connectome?</strong></h3>
	<div class="cT">
	  <br><br><br>
	  <ul class="ulS">
	    <li>It is unknown if frequency bands emerge from brain data, particularly at the network level.</li><br>
	    <li>We answer this question by examining all-to-all resting-state connectivity patterns (intrinsic connectome) at each frequency from <span class="nB">1</span> to <span class="nB">50</span> Hz.</li><br>
	    <li>Unsupervised learning at the group level is then used to determine if there are consistent frequency clusters across subjects.</li>
	  </ul>
	</div>
      </div>

      <div id="" class="step slide" data-x="-1000" data-y="500">
	<h3 class="hD"><strong>Connectome Methods</strong></h3>
	<div class="cT">
	  <br><br><br><br>
	  <ul class="ulS">
	    <li>35 healthy subjects</li><br>
	    <li>10 minutes of visually-fixated resting-state MEG</li><br>
	    <li>Source localize the resting-state signal</li><br>
	    <li>Calculate PLV for each frequency from 1-50 Hz between each pair source points (&nbsp;<span class="nB">$50\times 5124\times 5124$</span>&nbsp;)</li><br>
	    <li>Compare to PLV calculated from empty room data to remove cross-talk artifact</li>
	  </ul>
	</div>
      </div>
      
      <div id="" class="step slide" data-x="-1000" data-y="1500">
	<div id="chart1" class="cT" style="background-color:transparent; border: 3px dashed rgba(80, 80, 80, .3); border-radius: 20px; position:absolute; left:585px; top:285px">
	</div>
	<script src="./js/force_view.js"></script>
	
	<h3 class="hD"><strong>Unsupervised learning methods (normalization and graph similarity)</strong></h3>
	<div class="cT">
	  <br>First normalize the graphs remove global frequency effects (e.g. $1/f$) by equating the CDFs at each frequency.<br>
	  <span class="nI" style="font-size: 22px; padding-left: 18px; display:block">This removes any density bias and leaves only network structure for calculating similarity.</span><br>
	  <span class="nI" style="font-size: 24px;">We employ three graph similarity measures:</span><br><br>
	  <ul class="ulS" style="margin-top: -20px">
	    <li>$\mathbf{L}_1$ distance</li>
	    <span class="sbN">Average absolute edgewise difference</span><br><br>
	    <li>Degree distance</li>
	    <span class="sbN">One minus the weighted degree correlation</span><br><br>
	    <li>Local clustering coefficient (LCC) $\cdots$ distance</li>
	    <span class="sbN">One minus the LCC correlation between binarized graphs</span><br>
	    <span class="cP" style="display:block; transform: rotate(-90deg); right: -7px; top: 515px;"><a href="http://bl.ocks.org/benzguo/4370043" alt="" style="text-decoration: none; font-size:14px; background-color: transparent; font-variant: small-caps; text-shadow: none;">ben guo</a></span>
	  </ul>
	</div>
      </div>

      <div id="" class="step slide" data-x="250" data-y="1500" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/one_a.png" width="300px" height="310px" style="position:absolute; left:-40px; top: -40px; border-radius: 10px; padding: 5px; opacity: .8;"> </img>
	<span class="cP" style="left:105px; top:280px; color: rgba(16,170,204,.8);">$\mathbf{L}_\mathbf{1}$</span>
	<img class="brdr" src="./img/one_d.png" width="300px" height="310px" style="position:absolute; left:630px; top: 430px; border-radius: 10px; padding: 5px; opacity: .8;"> </img>
	<span class="cP" style="left:770px; top:395px; color: rgba(16,170,204,.8);">Degree</span>
	<img class="brdr" src="./img/one_l7.png" width="300px" height="310px" style="position:absolute; left:-40px; top: 430px; border-radius: 10px; padding: 5px; opacity: .8;"> </img>
	<span class="cP" style="left:90px; top:395px; color: rgba(16,170,204,.8);">$\mathbf{LCC}_{\mathbf{75}}$</span>
	<img class="brdr" src="./img/one_l8.png" width="300px" height="310px" style="position:absolute; left:295px; top: 180px; border-radius: 10px; padding: 5px; opacity: .8;"> </img>
	<span class="cP" style="left:430px; top:500px; color: rgba(16,170,204,.8);">$\mathbf{LCC}_{\mathbf{85}}$</span>
	<img class="brdr" src="./img/one_l9.png" width="300px" height="310px" style="position:absolute; left:630px; top: -40px; border-radius: 10px; padding: 5px; opacity: .8;"> </img>
	<span class="cP" style="left:770px; top:280px; color: rgba(16,170,204,.8);">$\textbf{LCC}_{\mathbf{95}}$</span>
      </div>

      <div id="" class="step slide" data-x="1500" data-y="1500" data-z="0" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/00.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>
      </div>

      <div id="" class="step slide" data-x="2000" data-y="1500" data-z="-500" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/02.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>	
      </div>

      <div id="" class="step slide" data-x="2500" data-y="1500" data-z="-1000" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/06.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>	
      </div>

      <div id="" class="step slide" data-x="3000" data-y="1500" data-z="-1500" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/07.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>	
      </div>

      <div id="" class="step slide" data-x="3500" data-y="1500" data-z="-2000" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/08.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>	
      </div>

      <div id="" class="step slide" data-x="4000" data-y="1500" data-z="-2500" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/13.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>	
      </div>

      <div id="" class="step slide" data-x="4500" data-y="1500" data-z="-3000" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/14.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>	
      </div>

      <div id="" class="step slide" data-x="5000" data-y="1500" data-z="-3500" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/26.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>	
      </div>

      <div id="" class="step slide" data-x="5500" data-y="1500" data-z="-4000" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/28.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>	
      </div>

      <div id="" class="step slide" data-x="6000" data-y="1500" data-z="-4500" data-rotate-y="0" style="border:none; box-shadow:none; background-color: transparent;">
	<img class="brdr" src="./img/stk/31.png" width="600px" height="620px" style="position:absolute; left:145px; top:45px; opacity: .8; padding: 10px; border-radius: 10px;"> </img>	
      </div>

      <div id="" class="step slide" data-x="-1000" data-y="2500">
	<h3 class="hD"><strong>Unsupervised learning methods (clustering)</strong></h3>
	<div class="cT">
	  <br><br><div class="nB" style="text-align:center"><span>Clusters correspond to frequency bands.</span></div><br>
	  <span class="ceM">Spectral clustering</span> is our method of choice.<br><br>
	  <ul class="ulS">
	    <li>The Ng-Jordan-Weiss interpretation of spectral clustering is adopted.</li><br>
	    <li>Spectral clustering works with the notion of similarities.</li>
	    <span class="sbN">We normalize the distance matrices to the $\mathbf{[0,1]}$ interval and subtract their off-diagonal entries from unity to arrive at a similarity matrix.</span><br><br>
	    <li>Instabilities</li>
	    <span class="sbN">We repeat the clustering process a number of times and assign the cluster (band) labels by majority vote.</span><br>
	  </ul>
	</div>
	<span class="cP" style="transform: rotate(-0deg); left:300px; top: 250px; color: #909090">Input parameter: number of clusters.</span>
      </div>

      <div id="" class="step slide" data-x="250" data-y="2500">
	<span class="cP sN" style="transform: rotate(-90deg); left:-260px; top: 360px">$V(X;Y) =\; -\,\sum_{i,j}\, \frac{\left|X_i\cap Y_j\right|}{|X|\equiv |Y|}\cdot\left\{\log\left(\frac{\left|X_i\cap Y_j\right|}{\left|X_i\right|}\right)+\log\left(\frac{\left|X_i\cap Y_j\right|}{\left|Y_j\right|}\right)\right\}$</span>
	<h3 class="hD"><strong>Clustering: how many bands? I</strong></h3>
	<div class="cT">
	  <br><br><div class="nB" style="text-align:center"><span>Exploiting the &lsquo;subject&rsquo; degree of freedom</span><br><span>to fix the number of clusters.</span></div><br>
	  <span class="ceM">Variation of Information</span> (VI) is used to quantify the inter-subject agreement. <span class="nI">For a given &lsquo;number of clusters&rsquo;:</span><br><br>
	  
	  <ul class="ulS">
	    <li>compute the average VI between all pairs of subjects;</li><br>
	    <li>(symmetrically) permute the distance matrices and recompute the first step a given number of times;</li><br>
	    <li>subtract the average of the second step from the first.</li>
	  </ul><br>
	  <div style="text-align: center"><span class="nI" style="font-size:20px">VI is computed over a pair of clustering outputs: partitions.</span></div>
	</div>
      </div>

      <div id="" class="step slide" data-x="1500" data-y="2500" data-z="0">
	<h3 class="hD"><strong>Clustering: how many bands? II</strong></h3>
	<img class="brdr" src="./img/voi.png" width="800px" height="491px" style="position:absolute; left:45px; top:160px; background-color: rgba(100,100,100,.3); opacity: .5;"> </img>
	<span class="cP" style="left:160px; bottom:2px; color: #e8e8e8; opacity: .7">Mean of permutation-shifted variation of information between all subject pairs</span>
      </div>

      <div id="" class="step slide" data-x="2750" data-y="2500" data-z="0">
	<h3 class="hD"><strong>Clustering: integration I</strong></h3>
	<div style="width: 100%; height: 100%; margin: 50px auto">
	  <img class="brdr" src="./img/cspa_lclcy_95.png" width="500px" height="500px" onmouseover="this.src='./img/cspa_degy.png'; document.getElementById('mse_0').innerHTML='Degree';" onmousedown="this.src='./img/cspa_adsty.png'; document.getElementById('mse_0').innerHTML='$\\hspace{1em}\\mathbf{L}_\\mathbf{1}$'; MathJax.Hub.Typeset();" onmouseout="this.src='./img/cspa_lclcy_95.png'; document.getElementById('mse_0').innerHTML='$\\hspace{.25em}\\mathbf{LCC}_\\mathbf{95}$'; MathJax.Hub.Typeset();" style="background-color: rgba(100,100,100,0); border-radius: 10px; padding: 10px; background-color: rgba(100,100,100,.2); opacity: .7;"> </img>
	</div>
	<span id="mse_0" class="cP ceM" style="bottom: 5px; left: 430px">$\hspace{.25em}\mathbf{LCC}_\mathbf{95}$</span>
      </div>

      <div id="" class="step slide" data-x="4000" data-y="2500" data-z="0">
	<h3 class="hD"><strong>Clustering: integration II</strong></h3>
	<div style="width: 100%; height: 100%; margin: 150px auto">
	  <img class="brdr" src="./img/cls.png" width="850px" height="300px" style="margin-left: -50px; background-color: rgba(100,100,100,0.2); border-radius: 10px; padding: 10px; opacity: .7;"> </img>
	</div>
      </div>
      
      <div id="" class="step slide" data-x="-3750" data-y="3500" data-z ="-1000" data-rotate-y="-90">
	<h3 class="hD"><strong>Questions</strong></h3>
	<div class="cT">
	  <br><br><br>
	  <ul class="ulS">
	    <li>Are there robust frequency bands/clusters in the intrinsic/resting-state connectome?</li>
            <span class="sbN">Yes, <span class="nB">5-7</span> bands emerge from the connectome.</span><br>
	    <li>How do these bands compare to the ad hoc canonical frequency bands?</li>
            <span class="sbN">Reasonably well, with clear beta split.</span><br>
	    <li>Are frequency bands associated with consistent connectivity profiles across individuals?</li><br>
	    <li>What are the band-specific networks?</li>
	  </ul>
	</div>
      </div>

      <div id="" class="step slide" data-x="-1000" data-y="3500">
	<h3 class="hD"><strong>Prediction: feature extraction</strong></h3>
	<div class="cT">
	  <br><br>We reduce the dimensionality of feature space from <span class="nB">13125126</span> to <span class="nB">50</span> Principal Pomponents (PC); the components derived from different subjects are combined:<br><br>
	  <ul class="ulS">
	    <li>collect the first PC from all subjects;</li><br>
	    <li>without centering the data, compute the first PC (moment) of the above;</li>
	    <span class="sbN">This is our first representative PC for all subjects: we keep it.</span><br><br>
	    <li>subtract the above vector from the remaining PCs of all subjects and subsequently renormalize them;</li><br>
	    <li>repteat the above with the remaining (transformed) PCs.</li>
	  </ul>
	</div>
      </div>
      
      <div id="" class="step slide" data-x="250" data-y="3500">
	<h3 class="hD"><strong>Prediction: classification I</strong></h3>
	<div style="position:absolute; left:120px; top:60px; opacity: .8;">
	  <div class="bk-root">
            <div class="plotdiv" id="9f177cc2-d298-4eaa-8e5d-f3e664a40206"></div>
	  </div>
	  <script src="./js/bk_0.js"></script>
	</div>
	<span style="font-size:22px; font-weight:bold">~80% classification accuracy<br>&nbsp;&nbsp;&nbsp;w/ SVM<span class="sB" style="color: rgba(3,126,183,.7);">RBF</span></span>
      </div>

      <div id="" class="step slide" data-x="1500" data-y="3500">
	<h3 class="hD"><strong>Prediction: classification II</strong></h3>
	<div style="position:absolute; left:120px; top:60px; opacity: .8;">
	  <div class="bk-root">
            <div class="plotdiv" id="0da11dc5-fc31-4161-8e91-da0c1798e8f8"></div>
	  </div>
	  <script src="./js/bk_1.js"></script>
	</div>
	<span style="font-size:22px; font-weight:bold">~75% classification accuracy<br>&nbsp;&nbsp;&nbsp;w/ SVM<span class="sB" style="color: rgba(3,126,183,.7);">Lin</span></span>
      </div>

      <div id="" class="step slide" data-x="2750" data-y="3500" data-z="0">
	<h3 class="hD"><strong>Prediction: confusion matrices</strong></h3>
	<div style="width: 100%; height: 100%; margin: 50px auto">
	  <img class="brdr" src="./img/cfn_lclcy7+.png" width="500px" height="500px" onmouseover="this.src='./img/cfn_degy5+.png'; document.getElementById('mse_1').innerHTML='Degree';" onmousedown="this.src='./img/cfn_adsty7+.png'; document.getElementById('mse_1').innerHTML='$\\hspace{1em}\\mathbf{L}_\\mathbf{1}$'; MathJax.Hub.Typeset();" onmouseout="this.src='./img/cfn_lclcy7+.png'; document.getElementById('mse_1').innerHTML='$\\hspace{.25em}\\mathbf{LCC}_\\mathbf{95}$'; MathJax.Hub.Typeset();" style="background-color: rgba(100,100,100,0); border-radius: 10px; padding: 10px; background-color: rgba(100,100,100,.2); opacity: .7;"> </img>
	</div>
	<span id="mse_1" class="cP ceM" style="bottom: 5px; left: 430px">$\hspace{.25em}\mathbf{LCC}_\mathbf{95}$</span>
      </div>
      
      <div id="" class="step slide" data-x="-3750" data-y="4500" data-z ="-1000" data-rotate-y="-90">
	<h3 class="hD"><strong>Questions</strong></h3>
	<div class="cT">
	  <br><br><br>
	  <ul class="ulS">
	    <li>Are there robust frequency bands/clusters in the intrinsic/resting-state connectome?</li>
            <span class="sbN">Yes, <span class="nB">5-7</span> bands emerge from the connectome.</span><br>
	    <li>How do these bands compare to the ad hoc canonical frequency bands?</li>
            <span class="sbN">Reasonably well, with clear beta split.</span><br>
	    <li>Are frequency bands associated with consistent connectivity profiles across individuals?</li>
	    <span class="sbN">Very consistent. Given an all-to-all connectivity matrix, can classify<br>with <span class="nB">> 75%</span> accuracy what band it is associated with.</span><br>
	    <li>What are the band-specific networks?</li>
	  </ul>
	</div>
      </div>
      
      <div id="" class="step slide" data-x="-1000" data-y="4500">
	<h3 class="hD"><strong>What are the band-specific networks?</strong></h3>
	<div class="cT">
	  <br><br>What network structure separates frequency band networks from one another?<br>
	  <br>Our current method is univariate.<br><br>
	  <span class="cP" style="left:130px; top:280px; font-size:22px; color: #808080">Room for improvement <span style="vertical-align:super;">&#x21b5;</span></span>
	  <ul class="ulS">
	    <li>For each edge,</li><br>
	    <li>and for each class/band,</li><br>
	    <li>we perform a $t$-test with a one-vs-rest decision function;</li><br>
	    <li>the resluting $p$-value is thresholded at a signifcance level, normalized and assigned to that edge, in that band, as its weight.</li>
	  </ul>
	</div>
      </div>

      <div class="step slide" data-x="250" data-y="4500">
	<h3 class="hD"><strong>Outcome</strong></h3>
	<div style="width: 800px; height: 500px; position: absolute; left: 42px; top: 150px; border: 5px solid #606060; border-radius: 5px;">
	  <div id="container" style="width: inherit; z-index: 0; opacity: .9;">
	    <div id="dat-gui-holder" style="position: absolute; top: 0em; right: 0em; z-index: 1;"></div>
	  </div>
	</div>
      </div>

      <div id="" class="step slide" data-x="-1000" data-y="5500">
	<h3 class="hD"><strong>Discussion</strong></h3>
	<div id="chart2" style="position: relative;"></div>
	<script src="./js/mn.js"></script>
	<div class="cT" style="font-size: 24px">
	  <br><br>To identify the network structure that separates a frequency band from others.<br><br>
	  <ul class="ulS">
	    <li>Frequency bands are associated with distinct network structure, with similar structure within bands and distinctions between bands.</li><br>
	    <li>Bands are similar to the canonical frequency bands from the literature.</li><br>
	    <li>Network structure in each band is highly consistent across individuals.</li><br>
	    <li>Hubs for each frequency are reasonable given what is believed to be the generators/critical nodes for frequency-specific oscillations.</li>
	  </ul>
	</div>
      </div>

      <div id="" class="step slide" data-x="250" data-y="5500">
	<h3 class="hD"><strong>Future directions</strong></h3>
	<div class="cT">
	  <br><br><br><br>
	  <ul class="ulS">
	    <li>May be able to define subject-specific bands using classification approach.</li><br><br>
	    <li>Graph comparison and network templates allow for multimodal comparisons and fusion.</li><br><br>
	    <li>High classification accuracy and robust pipeline make applying these methods to clinical populations (schizophrenia) for identifying pathology a natural next step.</li>
	  </ul>
	</div>
      </div>
      
      <div id="overview" class="step" data-x="3000" data-rotate-y="0" data-y="1500" data-scale="10">  
      </div>

    </div>

    <script id="vertexShader" type="x-shader/x-vertex">

     precision mediump float;
     precision mediump int;
     attribute vec4 color;
     varying vec4 vColor;

     void main() {
       vColor = color;
       gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
     }

    </script>

    <script id="fragmentShader" type="x-shader/x-fragment">

     precision mediump float;
     precision mediump int;
     varying vec4 vColor;

     void main() {
       vec4 color = vec4(vColor);
       gl_FragColor = color;
     }

    </script>

    <script>

     var oReq = new XMLHttpRequest();
     oReq.open("GET", "./ttest_ovr.ba", true);
     oReq.responseType = "arraybuffer";
     oReq.onload = function (oEvent,byteArray) {
       var arrayBuffer = oReq.response;
       if (arrayBuffer) {
	 var all =  new Float32Array(arrayBuffer);
	 var sZ = all[0];
	 var i = sZ * 3 + 1; // all[i] === #clusters
	 var vrt = all.subarray(1,i);
	 var cL = all[i];
	 i += 1; // all[i] === #edges in the first cluster
	 var clI = new Array(cL);
	 var clEW = new Array(cL);
	 var clVW = new Array(cL);
	 var pos;
	 for (var j=0; j<cL; j++) {
	   pos = i + 1 + all[i] * 2;
	   clI[j] = all.subarray(i+1,pos);
	   i = pos + all[i];
	   clEW[j] = all.subarray(pos,i);
	   clVW[j] = all.subarray(i,i+sZ);
	   i += sZ;
	 }
	 init(sZ,vrt,cL,clI,clEW,clVW);
       }
     };

     oReq.send(null);

     function init(sZ,vrt,cL,clI,clEW,clVW) {
       
       var container;
       var camera, scene, renderer;
       var mesh;
       container = document.getElementById( 'container' );

       var clock = new THREE.Clock();
       scene = new THREE.Scene();
       camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, .1, 100);
       camera.position.x = 6;
       camera.position.y = -2.0625;
       camera.position.z = 8;
       camera.lookAt(new THREE.Vector3(0,0,0));

       var orbitControls = new THREE.OrbitControls(camera);
       orbitControls.autoRotate = true;
       orbitControls.autoRotateSpeed = .25;
       orbitControls.userrotateSpeed = 1.0;
       orbitControls.userPan = false;
       orbitControls.enableDamping = true;
       orbitControls.dampingFactor = 0.25;
       orbitControls.minDistance = .5;
       orbitControls.maxDistance = 50;

       var clstr = 0;
       var opaV = .9;
       var opaE = .25;
       var rdns = .85;
       var segs_ = 500;
       var wdth = 2;

       var genTex = function () {
	 var canvas = document.createElement("canvas");
	 canvas.width = 32;
	 canvas.height = 32;
	 var ctx = canvas.getContext("2d");
	 var gradient = ctx.createRadialGradient(16,16,16,16,16,0);
	 gradient.addColorStop(0,"black");
	 gradient.addColorStop(1,"white");
	 ctx.fillStyle = gradient;
	 ctx.fillRect(0,0,32,32);
	 var texture = new THREE.Texture(canvas);
	 texture.needsUpdate = true;
	 return texture;
       };

       var geom = new THREE.Geometry();
       var vmaterial = new THREE.PointsMaterial({
	 size: .65,
	 vertexColors: true,
	 map: genTex(),
	 blending: THREE.AdditiveBlending,
	 depthWrite: false,
	 transparent: true,
	 opacity: opaV
       });

       var num, den;
       for (var i=0; i<sZ; i++) {
	 geom.vertices.push(new THREE.Vector3(vrt[i*3],vrt[i*3+1],vrt[i*3+2]));
	 num = (1-clVW[clstr][i])*(1-rdns);
	 den = clVW[clstr][i]*(rdns) + num;
	 if (den > 0)
	   num /= den;
	 geom.colors[i] = new THREE.Color().setRGB(1, num, num);
       }
       
       vgroup = new THREE.Points(geom, vmaterial);
       vgroup.rotation.x = - Math.PI / 2;
       vgroup.rotation.z = - Math.PI / 3;
       vgroup.sortParticles = true;
       scene.add(vgroup);
       
       var segs = new Array(cL);
       for (var i=0; i<cL; i++)
	 segs[i] = Math.min(segs_,clI[i].length/2);;

       var geometry = new THREE.BufferGeometry();
       var material = new THREE.ShaderMaterial({
	 vertexShader: document.getElementById('vertexShader').textContent,
	 fragmentShader: document.getElementById('fragmentShader').textContent,
	 transparent: true,
	 blending: THREE.AdditiveBlending, 
	 depthTest: false,
	 linewidth: wdth
       });

       var positions = new Float32Array(segs[clstr] * 3 * 2);
       var colors = new Float32Array(segs[clstr] * 4 * 2);

       for (var i=0; i<segs[clstr]; i++) {
	 var rgb = [60/255, 130/255, 255/255];
	 var vi = clI[clstr][2*i];
	 positions[i*6+0] = vrt[vi*3];
	 positions[i*6+1] = vrt[vi*3+1];
	 positions[i*6+2] = vrt[vi*3+2];
	 var vi = clI[clstr][2*i+1];
	 positions[i*6+3] = vrt[vi*3];
	 positions[i*6+4] = vrt[vi*3+1];
	 positions[i*6+5] = vrt[vi*3+2];

	 colors[i*8] = rgb[0];
	 colors[i*8+1] = rgb[1];
	 colors[i*8+2] = rgb[2];
	 colors[i*8+3] = clEW[clstr][i] * opaE;
	 colors[i*8+4] = rgb[0];
	 colors[i*8+5] = rgb[1];
	 colors[i*8+6] = rgb[2];
	 colors[i*8+7] = clEW[clstr][i] * opaE;
       }

       geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));
       geometry.addAttribute('color', new THREE.BufferAttribute(colors, 4, true));
       geometry.computeBoundingSphere();

       var mesh = new THREE.LineSegments(geometry, material);
       mesh.rotation.x = - Math.PI / 2;
       mesh.rotation.z = - Math.PI / 3;
       scene.add(mesh);

       renderer = new THREE.WebGLRenderer({antialias: false});
       renderer.setClearColor(0x101010);
       renderer.setPixelRatio(window.devicePixelRatio);
       renderer.setSize(window.innerWidth, window.innerHeight);
       renderer.gammaInput = true;
       renderer.gammaOutput = true;

       container.appendChild(renderer.domElement);

       window.addEventListener('resize', onWindowResize, false);

       render()
       
       var controls = new function () {
	 this.clstr = clstr + 1;
	 this.edgs = segs[clstr];
	 this.vopa = opaV;
	 this.vcol = rdns;
	 this.eopa = opaE;
	 this.wdth = wdth;
	 this.rtn = orbitControls.autoRotate;
       };

       // var gui = new dat.GUI();
       // dat.GUI.toggleHide();
       var gui = new dat.GUI({autoPlace: false});
       document.getElementById('dat-gui-holder').appendChild(gui.domElement);
       gui.close()
       
       gui.add(controls, 'clstr', 1, cL).step(1).name("Cluster #").onChange(clstrC);
       gui.add(controls, 'edgs', 0, clI[clstr].length/2).step(1).name("#Edges").onChange(edgsC);
       gui.add(controls, 'vopa', 0, 1).name("Vertex Opacity").onChange(vopaC);
       gui.add(controls, 'vcol', 0, 1).name("Vertex Color").onChange(vcolC);
       gui.add(controls, 'eopa', 0, 1).name("Edge Opacity").onChange(eopaC);
       gui.add(controls, 'wdth', 1, 4).step(1).name("Edge Width").onChange(wdthC);
       gui.add(controls, 'rtn').name("Auto-Rotate").onChange(rtnC);

       function rtnC() {
	 orbitControls.autoRotate = controls.rtn;
       }
       
       function wdthC() {
	 material.linewidth = controls.wdth;
       }
       
       function vcolC() {
	 rdns = controls.vcol;
	 for (var i=0; i<sZ; i++) {
	   num = (1-clVW[clstr][i])*(1-rdns);
	   den = clVW[clstr][i]*(rdns) + num;
	   if (den > 0)
	     num /= den;
	   geom.colors[i] = new THREE.Color().setRGB(1, num, num);
	 }
	 geom.colorsNeedUpdate = true;
       }
       
       function eopaC() {
	 opaE = controls.eopa;
	 for (var i=0; i<segs[clstr]; i++) {
	   colors[i*8+3] = clEW[clstr][i] * opaE;
	   colors[i*8+7] = clEW[clstr][i] * opaE;
	 }
	 geometry.attributes.color.needsUpdate = true;
       }
       
       function vopaC() {
	 vmaterial.opacity = controls.vopa;
       }
       
       function edgsC() {
	 segs[clstr] = controls.edgs;
	 positions = new Float32Array(segs[clstr] * 3 * 2);
	 colors = new Float32Array(segs[clstr] * 4 * 2);
	 for (var i=0; i<segs[clstr]; i++) {
	   var vi = clI[clstr][2*i];
	   positions[i*6+0] = vrt[vi*3];
	   positions[i*6+1] = vrt[vi*3+1];
	   positions[i*6+2] = vrt[vi*3+2];
	   var vi = clI[clstr][2*i+1];
	   positions[i*6+3] = vrt[vi*3];
	   positions[i*6+4] = vrt[vi*3+1];
	   positions[i*6+5] = vrt[vi*3+2];

	   colors[i*8] = rgb[0];
	   colors[i*8+1] = rgb[1];
	   colors[i*8+2] = rgb[2];
	   colors[i*8+3] = clEW[clstr][i] * opaE;
	   colors[i*8+4] = rgb[0];
	   colors[i*8+5] = rgb[1];
	   colors[i*8+6] = rgb[2];
	   colors[i*8+7] = clEW[clstr][i] * opaE;
	 }
	 geometry.position = null;
	 geometry.color = null;
	 geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));
	 geometry.addAttribute('color', new THREE.BufferAttribute(colors, 4, true));
	 geometry.attributes.position.needsUpdate = true;
	 geometry.attributes.color.needsUpdate = true;
       }
       
       function clstrC() {
	 clstr = controls.clstr-1;
	 controls.edgs = segs[clstr];
	 document.getElementById('dat-gui-holder').removeChild(gui.domElement);    /// <<<<<
	 gui.destroy();
	 // gui = new dat.GUI();
	 gui = new dat.GUI({autoPlace: false});
	 document.getElementById('dat-gui-holder').appendChild(gui.domElement);

	 gui.add(controls, 'clstr', 1, cL).step(1).name("Cluster #").onChange(clstrC);
	 gui.add(controls, 'edgs', 0, clI[clstr].length/2).step(1).name("#Edges").onChange(edgsC);
	 gui.add(controls, 'vopa', 0, 1).name("Vertex Opacity").onChange(vopaC);
	 gui.add(controls, 'vcol', 0, 1).name("Vertex Color").onChange(vcolC);
	 gui.add(controls, 'eopa', 0, 1).name("Edge Opacity").onChange(eopaC);
	 gui.add(controls, 'wdth', 1, 4).step(1).name("Edge Width").onChange(wdthC);
	 gui.add(controls, 'rtn').name("Auto-Rotate").onChange(rtnC);

	 positions = new Float32Array(segs[clstr] * 3 * 2);
	 colors = new Float32Array(segs[clstr] * 4 * 2);
	 for (var i=0; i<segs[clstr]; i++) {
	   var vi = clI[clstr][2*i];
	   positions[i*6+0] = vrt[vi*3];
	   positions[i*6+1] = vrt[vi*3+1];
	   positions[i*6+2] = vrt[vi*3+2];
	   var vi = clI[clstr][2*i+1];
	   positions[i*6+3] = vrt[vi*3];
	   positions[i*6+4] = vrt[vi*3+1];
	   positions[i*6+5] = vrt[vi*3+2];

	   colors[i*8] = rgb[0];
	   colors[i*8+1] = rgb[1];
	   colors[i*8+2] = rgb[2];
	   colors[i*8+3] = clEW[clstr][i] * opaE;
	   colors[i*8+4] = rgb[0];
	   colors[i*8+5] = rgb[1];
	   colors[i*8+6] = rgb[2];
	   colors[i*8+7] = clEW[clstr][i] * opaE;
	 }
	 geometry.position = null;
	 geometry.color = null;
	 geometry.addAttribute( 'position', new THREE.BufferAttribute(positions, 3));
	 geometry.addAttribute( 'color', new THREE.BufferAttribute(colors, 4, true) );
	 geometry.attributes.position.needsUpdate = true;
	 geometry.attributes.color.needsUpdate = true;

	 for (var i=0; i<sZ; i++) {
	   num = (1-clVW[clstr][i])*(1-rdns);
	   den = clVW[clstr][i]*(rdns) + num;
	   if (den > 0)
	     num /= den;
	   geom.colors[i] = new THREE.Color().setRGB(1, num, num);
	 }
	 geom.colorsNeedUpdate = true;
	 
       }

       function render() {
	 var delta = clock.getDelta();
	 orbitControls.update(delta);
	 requestAnimationFrame(render);
	 renderer.render(scene, camera)
       }

       function onWindowResize() {
	 camera.aspect = window.innerWidth / window.innerHeight;
	 camera.updateProjectionMatrix();
	 renderer.setSize( window.innerWidth, window.innerHeight );
       }
       
     }

    </script>
    
    <script src="js/impress.js"></script>
    
    <script src="js/impress-slide-num.js"></script>
    
    <script>
     var obj = impress();
     obj.init();
     initSlideNo(obj);
    </script>

  </body>
</html>
